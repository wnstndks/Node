<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link href="/main.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>

<body class="grey-bg">

  <!-- include() ì“°ë©´ ë‹¤ë¥¸ ejs íŒŒì¼ì— ìˆë˜ html ë³µì‚¬í•´ì˜¬ìˆ˜ ìˆìŒ -->
  <!-- ì´ íŒŒì¼ì— ìˆë˜ html ë³µì‚¬í•´ì˜´ -->
  <%- include('nav.ejs') %>
    <!-- ìœ„ì— < % - includeê°™ì´ íŠ¹ìˆ˜í•œ ë¬¸ë²•ê°€ì ¸ë‹¤ ì“¸ë•Œ -->

    <!-- ì„œë²„ì‚¬ì´ë“œ ë Œë”ë§ - htmlì„ ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ë³´ë‚¼ë•Œ ë¯¸ë¦¬ ìë¦¬ë¥¼ ì±„ì›Œì„œ ìœ ì €ì—ê²Œë³´ë‚´ëŠ”ê²ƒ -->

    <!-- í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë Œë”ë§ - ì„œë²„ì—ì„œ ë¹ˆ html + ë°ì´í„°ë¥¼ ë³´ë‚´ê³  ìœ ì € ë¸Œë¼ìš°ì €ì—ì„œ html ìƒì„±í•˜ëŠ”ê²ƒ -->
    <!-- html ì‚¬ì´ì— array object ë„£ìœ¼ë©´ ê¹¨ì§ -> JSONí˜•íƒœë¡œ ë°”ê¾¸ì–´ì•¼í•¨ -->
    <!-- < % = JSON.stringify(ê¸€ëª©ë¡) %> -->

    <div class="white-bg">
      <!-- ejs íŒŒì¼ ì•ˆì—ì„œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¬¸ë²• ìƒì„± ê°€ëŠ¥ ì•„ë¬´ë°ì„œë‚˜ ê°€ëŠ¥í•¨ -->
      <% for (let i=0; i<ê¸€ëª©ë¡.length; i++){%>
        <!--ìœ„ì— ê·¸ëƒ¥ < % ëŠ” html ì‚¬ì´ì— ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¬¸ë²• ì“¸  -->
        <div class="list-box">
          <!-- ë°‘ì— < % = ëŠ” ì´ ì•ˆì— ìˆëŠ” ë°ì´í„°ê°€ html í˜•ì‹ì¼ ê²½ìš°ì— ì‹¤ì œ html íƒœê·¸ì²˜ëŸ¼ ë‚˜ì˜¤ëŠ”ê²Œ ì•„ë‹ˆë¼ ë¬¸ìì²˜ëŸ¼ ë°”ê¿”ì„œ ë§Œë“¤ì–´ì¤Œ < % -ëŠ” ì‹¤ì œ htmlì´ ë Œë”ë§ë˜ì–´ ë‚˜ì˜´  -->
          <!-- ê·¸ëŸ°ë° ê¸€ idë¥¼ ì–´ë–»ê²Œ ì…ë ¥í•˜ê² ì–´ -> ë§í¬ë§Œë“¤ì–´ì•¼ -->
          <h4><a href='/detail/<%=ê¸€ëª©ë¡[i]._id%>'>
              <%= ê¸€ëª©ë¡[i].title %>
            </a>
            <a href="/edit/<%=ê¸€ëª©ë¡[i]._id%>">âœï¸</a>
            <!-- htmlì— _id ìˆ¨ê²¨ë†¨ë‹¤ê°€ ê°€ì ¸ì˜¤ê¸° : data-ì´ë¦„ -->
            <span class="delete" data-id="<%=ê¸€ëª©ë¡[i]._id%>">ğŸ—‘ï¸</span>
          </h4>
          <p>
            <%= ê¸€ëª©ë¡[i].content %>
          </p>
        </div>
        <% } %>
    </div>

    <!-- ì‚­ì œë²„íŠ¼ ëˆ„ë¥´ë©´ ajaxì¨ì„œ ì„œë²„ë¡œ ìš”ì²­ -->
    <script>


      document.querySelectorAll('.delete')[0].addEventListener('click', function () {

        // ì„œë²„ì— ì‚­ì œ ìš”ì²­ ë‚ ë¦¬ê¸° - ajaxì´ìš© => ìƒˆë¡œê³ ì¹¨ì—†ì´ë„ getìš”ì²­ì´ìš© ê°€ëŠ¥
        // fetch('/url~~', {
        //   // ì´ê±´ POSTìš”ì²­í•˜ëŠ” ë²•
        //   method : 'POST',

        //   // ajaxë¡œ ë°ì´í„°ìš”ì²­ì€ 
        //   header : {
        //     'Content-Type' : 'application/json'
        //   },
        //   body : 'ë°ì´í„°ì „ì†¡~~'         
        // })


        // e.target.dataset.idë¥¼ < % = ê¸€ëª©ë¡[0]._id % >ì´ê±° ëŒ€ì‹ ì— ë„£ì–´ì£¼ëŠ”ê²Œ ì¢‹ìŒ
        // script ì•ˆì—ì„œ ejs ë¬¸ë²•ì€ ë¬¸ìì•ˆì— ë‹´ì•„ì•¼í•¨
        fetch('/delete?docid=' + '<%=ê¸€ëª©ë¡[0]._id %>', {
          method: 'DELETE',
        })
      })


    </script>

    <!-- ì„œë²„ë¡œ ë°ì´í„°ë³´ë‚´ëŠ” ë°©ë²• - form, ajax, query string, URL parameter - serverì—ì„œ :id ì´ëŸ°ì‹ìœ¼ë¡œ  -->

    <!-- fetch('/abc?ë°ì´í„°ì´ë¦„=ë°ì´í„°ê°’',{
      //ì´ëŸ° ì´ë¦„ìœ¼ë¡œ ë°ì´í„°ê°’ì´ ì „ì†¡ì´ ë¨
    },
        }) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"></script>
</body>

</html>